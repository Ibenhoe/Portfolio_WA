<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profiel</title>
    <link rel="stylesheet" href="../css/profiel.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: beige; /* Achtergrondkleur beige behouden */
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .bitcoin-container {
            display: flex;
            align-items: center;
            margin-top: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        .bitcoin-graphic {
            width: 400px; /* Groter gemaakt */
            margin-right: 20px;
        }
        .bitcoin-info {
            display: flex;
            flex-direction: column;
        }
        .bitcoin-info h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        .bitcoin-info p {
            margin: 5px 0;
        }
        .bet-options {
            margin-top: 20px;
            display: flex; /* Toegevoegd */
            flex-direction: column; /* Toegevoegd */
        }
        .bet-options label {
            margin-right: 10px;
        }
        .bet-options input[type="number"] {
            padding: 5px;
            margin-bottom: 10px; /* Toegevoegd */
            border-radius: 4px;
            border: 1px solid #ccc;
        }
        .bet-options button {
            padding: 8px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-bottom: 10px; /* Toegevoegd */
        }
        .bet-options button:hover {
            background-color: #0056b3;
        }
        #result {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="navigatie">
            <a href="index.html" class="home"></a>
            <a href="#" class="profiel"></a>
            <a href="#" class="inbox"></a>
            <a href="help.html" class="help"></a>
        </div>

        <div class="bitcoin-container">
            <img class="bitcoin-graphic" src="" alt="Bitcoin Graphic">

            <div class="bitcoin-info">
                <h1>Bitcoin</h1>
                <p>Startkapitaal: <span id="startAmount">1000</span> euro</p>
                <div class="bet-options">
                    <label for="betAmount">Inzet (in euro's):</label>
                    <input type="number" id="betAmount" min="1">
                    <button onclick="betOnPrice(true)" style="background-color: #28a745;">Gokken op hoger</button>
                    <button onclick="betOnPrice(false)" style="background-color: #dc3545;">Gokken op lager</button>
                    <p id="result"></p>
                </div>
            </div>
        </div>
    </div>
   
    <footer id="footer_2"></footer>

    <script>
        fetch("https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=1")
            .then(response => response.json())
            .then(data => {
                const prices = data.prices.map(price => price[1]);
                const aggregatedPrices = aggregatePrices(prices, 24); // Aggregating prices over 24-hour periods
                const sparklineData = {
                    type: 'line',
                    data: {
                        labels: aggregatedPrices.map((_, index) => `-${index * 4}h`), // Generating labels for x-axis
                        datasets: [{
                            label: 'Bitcoin Price (USD)',
                            data: aggregatedPrices,
                            borderColor: 'blue',
                            backgroundColor: 'rgba(0, 0, 255, 0.1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                scaleLabel: {
                                    display: true,
                                    labelString: 'Price (USD)'
                                }
                            }],
                            xAxes: [{
                                scaleLabel: {
                                    display: true,
                                    labelString: 'Time'
                                }
                            }]
                        }
                    }
                };
                const sparklineUrl = `https://quickchart.io/chart?c=${encodeURIComponent(JSON.stringify(sparklineData))}`;

                const bitcoinGraphic = document.querySelector('.bitcoin-graphic');
                bitcoinGraphic.onload = () => console.log('Afbeelding geladen');
                bitcoinGraphic.onerror = () => {
                    console.error('Fout bij het laden van de afbeelding');
                    console.log('Probeer deze URL in je browser:', sparklineUrl);
                };
                bitcoinGraphic.src = sparklineUrl;
            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });

        function aggregatePrices(prices, interval) {
            const aggregatedPrices = [];
            for (let i = 0; i < prices.length; i += interval) {
                const chunk = prices.slice(i, i + interval);
                const average = chunk.reduce((sum, price) => sum + price, 0) / chunk.length;
                aggregatedPrices.push(average);
            }
            return aggregatedPrices;
        }

        function betOnPrice(isGoingUp) {
            const betAmount = parseFloat(document.getElementById('betAmount').value);
            const startAmount = parseFloat(document.getElementById('startAmount').innerText);
            const randomChange = Math.random(); // Generate random number between 0 and 1

            let resultMessage = "";

            if (isNaN(betAmount) || betAmount <= 0) {
                resultMessage = "Voer een geldige inzet in.";
            } else {
                let result;
                if ((isGoingUp && randomChange > 0.5) || (!isGoingUp && randomChange <= 0.5)) {
                    result = startAmount + betAmount;
                    resultMessage = `Je hebt juist gegokt! Je wint ${betAmount.toFixed(2)} euro.<br>Je totale kapitaal nu: ${result.toFixed(2)} euro`;
                } else {
                    result = startAmount - betAmount;
                    resultMessage = `Je hebt verkeerd gegokt! Je verliest ${betAmount.toFixed(2)} euro.<br>Je totale kapitaal nu: ${result.toFixed(2)} euro`;
                }
                document.getElementById('startAmount').innerText = result.toFixed(2);
            }

            document.getElementById('result').innerHTML = resultMessage;
        }
    </script>
</body>
</html>
